"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.randomKey = void 0;
const get_random_values_1 = __importDefault(require("get-random-values"));
// WHATWG crypto RNG - https://w3c.github.io/webcrypto/Overview.html
function whatwgRNG(length = 16) {
    const rnds8 = new Uint8Array(length);
    get_random_values_1.default(rnds8);
    return rnds8;
}
const byteToHex = [];
for (let i = 0; i < 256; ++i) {
    byteToHex[i] = (i + 0x100).toString(16).substring(1);
}
function randomKey(length) {
    return whatwgRNG(length)
        .reduce((str, n) => str + byteToHex[n], '')
        .slice(0, length);
}
exports.randomKey = randomKey;
//# sourceMappingURL=randomKey.js.map